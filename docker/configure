#!/bin/sh

cd "$(dirname "$(readlink -f "$0")")"
. ../.bin/misc/throw

[ -f .env ] || echo -e "cat <<END_OF_TEXT\n$(cat .env.template)\nEND_OF_TEXT" | sh > .env

read -p 'Finalize configuration? [y/N] ' -e 'answer'
[ "$answer" == 'y' ] || throw "Configuration aborted"

. ./.env

echo 'Creating missing directories...'
for directory in portainer heimdall; do
	sudo -u "$PUID" -- mkdir -p "$CONFIG/$directory"
done

echo 'Containers configured successfully'
